# 운영 계획 문서

## 1. 개요

본 문서는 '통합 CMS 채팅 시스템'의 안정적인 운영을 위한 배포, 모니터링, 백업, 보안 정책을 정의합니다.

## 2. 배포(Deployment) 계획

### 2.1. 인프라 구성

- **프론트엔드**: Vercel 또는 AWS S3/CloudFront를 사용한 정적 호스팅을 권장합니다.
- **백엔드**: AWS EC2, Beanstalk 또는 Docker 컨테이너 기반의 클라우드 서버 (NCP, KT Cloud 등)
- **데이터베이스**: AWS RDS, 또는 서버에 직접 설치한 MariaDB

### 2.2. 배포 파이프라인 (CI/CD)

- **소스코드 관리**: GitHub, GitLab
- **CI/CD 도구**: Jenkins, GitHub Actions, GitLab CI
- **프로세스**:
  1. `develop` 브랜치에 코드가 push되면, 개발 서버에 자동으로 배포됩니다.
  2. `main` 또는 `master` 브랜치에 코드가 병합(merge)되면, 운영 서버에 배포되기 전 수동 승인 단계를 거칩니다.
  3. 무중단 배포를 위해 Blue/Green 또는 Rolling 배포 전략을 적용합니다.

## 3. 모니터링(Monitoring) 계획

### 3.1. 서버 및 인프라 모니터링

- **대상**: CPU, Memory, Disk 사용량, 네트워크 트래픽
- **도구**: Prometheus + Grafana, Datadog, AWS CloudWatch
- **알림**: 특정 임계치(예: CPU 사용량 80% 이상 5분 지속) 초과 시 Slack 또는 이메일로 담당자에게 알림을 발송합니다.

### 3.2. 애플리케이션 성능 모니터링 (APM)

- **대상**: API 응답 시간, 에러 발생률, DB 쿼리 성능
- **도구**: Pinpoint, Scouter, Datadog APM
- **목적**: 병목 지점을 찾아 성능을 개선하고, 예외 발생 시 스택 트레이스를 추적하여 신속하게 원인을 파악합니다.

### 3.3. 로그 관리

- **로그 수집**: ELK Stack (Elasticsearch, Logstash, Kibana) 또는 EFK Stack (Fluentd)을 사용하여 여러 서버에 흩어진 로그를 중앙에서 수집합니다.
- **로그 분석**: Kibana 대시보드를 통해 특정 조건(에러 레벨, 특정 사용자 등)의 로그를 검색하고 시각화합니다.

## 4. 데이터 백업 및 복구

### 4.1. 백업 정책

- **대상**: MariaDB 데이터베이스
- **주기**:
  - **전체 백업**: 매일 새벽 3시 (1일 1회)
  - **증분 백업**: 1시간 단위 (선택 사항)
- **보관**: 백업 파일은 최소 14일간 별도의 스토리지(예: AWS S3)에 암호화하여 저장합니다.

### 4.2. 복구 계획

- **RTO (복구 목표 시간)**: 2시간 이내
- **RPO (복구 목표 시점)**: 최대 24시간 전 데이터
- **절차**: 재해 발생 시, 사전에 정의된 복구 절차서에 따라 가장 최신의 백업 파일을 사용하여 시스템을 복구합니다. 정기적인 복구 훈련을 통해 절차를 검증합니다.

## 5. 보안 강화 계획

### 5.1. 네트워크 보안

- **방화벽**: 필요한 포트(80, 443, WebSocket 포트 등)만 외부에 노출하고 나머지 포트는 모두 차단합니다.
- **HTTPS**: 모든 통신 구간에 SSL/TLS를 적용하여 데이터를 암호화합니다.

### 5.2. 애플리케이션 보안

- **XSS (Cross-Site Scripting)**: 클라이언트로부터 입력받는 모든 데이터에 대해 HTML 이스케이프 처리를 하여 악성 스크립트 실행을 방지합니다. (예: `lucy-xss-filter`)
- **SQL Injection**: JPA와 같은 ORM을 사용하여 동적 쿼리 생성을 최소화하고, 파라미터 바인딩을 통해 SQL 인젝션을 방지합니다.
- **파일 업로드 취약점**:
  - 서버에서 파일 확장자를 검사하여 실행 가능한 파일(`exe`, `sh` 등)의 업로드를 제한합니다.
  - 업로드된 파일은 웹 서버의 실행 권한이 없는 별도의 경로에 저장합니다.
  - 파일 다운로드 시, 반드시 권한 검사를 거치도록 합니다.

### 5.3. 데이터 보안

- **개인정보**: 데이터베이스에 저장되는 비밀번호 등 민감한 정보는 반드시 암호화(BCrypt 등)하여 저장합니다.
- **데이터 보관 주기**: 법적 요구사항 및 내부 정책에 따라 채팅 기록 및 첨부파일의 보관 주기를 설정하고, 주기가 지난 데이터는 안전하게 파기하는 절차를 마련합니다.
- **감사 로그 (Audit Logs)**:
  - **목적**: 모든 데이터의 생성 및 수정 이력(`created_by`, `updated_by` 등)은 중요한 감사 로그로 활용됩니다.
  - **관리**: 비정상적인 데이터 변경(무단 수정, 삭제 등)이 의심될 경우, 해당 로그를 우선적으로 추적하여 원인을 파악합니다.
  - **보호**: 감사 로그 데이터는 다른 운영 데이터와 동일한 수준의 백업 및 보안 정책을 적용하여 보호합니다.
